vms:
- vm_jobs:
  - container_job: InstallMaster
    tests:
    - test_integration/test_installation.py::TestInstallMaster

  - container_job: kerberos_flags
    containers:
      clients: 1
    tests:
    - test_integration/test_kerberos_flags.py

  - container_job: forced_client_reenrollment
    containers:
      replicas: 1
      clients: 1
    tests:
    - test_integration/test_forced_client_reenrollment.py

  - container_job: external_ca_ExternalCAInstall
    tests:
    - test_integration/test_external_ca.py::TestExternalCAInstall

  - container_job: membermanager
    tests:
    - test_integration/test_membermanager.py

- vm_jobs:
  # DNSSEC support is in progress on ALT
  # - container_job: InstallDNSSECFirst
  #   containers:
  #     replicas: 1
  #   tests:
  #   - test_integration/test_dnssec.py::TestInstallDNSSECFirst

  - container_job: simple_replication
    containers:
      replicas: 1
    tests:
    - test_integration/test_simple_replication.py

  - container_job: service_permissions
    tests:
    - test_integration/test_service_permissions.py

  - container_job: netgroup
    tests:
    - test_integration/test_netgroup.py

  - container_job: external_ca_ExternalCAProfileScenarios
    tests:
    - test_integration/test_external_ca.py::TestExternalCAProfileScenarios

  # requires external DNS configuration, this is not set up yet
  # - container_job: authselect
  #   containers:
  #     clients: 1
  #   tests:
  #   - test_integration/test_authselect.py

- vm_jobs:
  - container_job: sudo
    containers:
      clients: 1
    tests:
    - test_integration/test_sudo.py

  - container_job: external_ca_ExternalCA
    containers:
      replicas: 1
      clients: 1
    tests:
    - test_integration/test_external_ca.py::TestExternalCA

  # requires nothing, installs nothing
  - container_job: topologies_and_testconfig
    tests:
    - test_integration/test_topologies.py
    - test_integration/test_testconfig.py

  - container_job: external_ca_SelfExternalSelf
    tests:
    - test_integration/test_external_ca.py::TestSelfExternalSelf

  - container_job: external_ca_ExternalCAConstraints
    containers:
      clients: 1
    tests:
    - test_integration/test_external_ca.py::TestExternalCAConstraints

- vm_jobs:
  - container_job: commands
    tests:
    - test_integration/test_commands.py

- vm_jobs:
  - container_job: ServerReplicaCALessToCAFull
    tests:
    - test_integration/test_caless.py::TestServerReplicaCALessToCAFull
    containers:
      replicas: 1

  - container_job: SubCAkeyReplication
    containers:
      replicas: 1
    tests:
    - test_integration/test_replica_promotion.py::TestSubCAkeyReplication

  - container_job: nfs
    containers:
      clients: 3
    tests:
    - test_integration/test_nfs.py

- vm_jobs:
  - container_job: ntp_options_common
    tests:
    - test_integration/test_ntp_options.py::TestNTPoptionsCommon
    containers:
      replicas: 1
      clients: 1

  - container_job: otp
    tests:
    - test_integration/test_otp.py

  - container_job: adtrust_install
    tests:
    - test_integration/test_adtrust_install.py
    containers:
      replicas: 1

- vm_jobs:
  - container_job: ntp_options_chrony
    tests:
    - test_integration/test_ntp_options.py::TestNTPoptions
    args: '-k chrony'
    containers:
      replicas: 1
      clients: 1

  - container_job: cert
    tests:
    - test_integration/test_cert.py
    containers:
      replicas: 1
      clients: 1

- vm_jobs:
  - container_job: ntp_options_ntpd
    tests:
    - test_integration/test_ntp_options.py::TestNTPoptions
    args: '-k "ntpd and not openntpd"'
    containers:
      replicas: 1
      clients: 1

  - container_job: upgrade
    tests:
    - test_integration/test_upgrade.py

  - container_job: http_kdc_proxy
    tests:
    - test_integration/test_http_kdc_proxy.py
    containers:
      clients: 1

- vm_jobs:
  - container_job: ntp_options_openntpd
    tests:
    - test_integration/test_ntp_options.py::TestNTPoptions
    args: '-k openntpd'
    containers:
      replicas: 1
      clients: 1

  - container_job: vault
    tests:
    - test_integration/test_vault.py
    containers:
      replicas: 1

- vm_jobs:
  - container_job: server_del
    tests:
    - test_integration/test_server_del.py
    containers:
      replicas: 2
      clients: 1

  - container_job: idviews_TestRulesWithServicePrincipals
    tests:
    - test_integration/test_idviews.py::TestRulesWithServicePrincipals

  - container_job: idviews_TestIDViews
    tests:
    - test_integration/test_idviews.py::TestIDViews
    containers:
      clients: 1

- vm_jobs:
  - container_job: backup_and_restore_TestBackupAndRestore
    tests:
    - test_integration/test_backup_and_restore.py::TestBackupAndRestore

  - container_job: user_permissions
    tests:
    - test_integration/test_user_permissions.py
    containers:
      clients: 1

  - container_job: dns_locations
    tests:
    - test_integration/test_dns_locations.py
    containers:
      replicas: 2

- vm_jobs:
  - container_job: pkinit_manage
    tests:
    - test_integration/test_pkinit_manage.py
    containers:
      replicas: 1

  - container_job: automember
    tests:
    - test_integration/test_automember.py

  - container_job: crlgen_manage
    tests:
    - test_integration/test_crlgen_manage.py
    containers:
      replicas: 1

  - container_job: ca_custom_sdn
    tests:
    - test_integration/test_ca_custom_sdn.py

- vm_jobs:
  - container_job: krbtpolicy
    tests:
    - test_integration/test_krbtpolicy.py

  - container_job: epn
    tests:
    - test_integration/test_epn.py
    containers:
      clients: 1

- vm_jobs:
  # test_ipa_healthcheck_no_errors requires at least 20% of free space
  - container_job: ipahealthcheck_TestIpaHealthCheck
    tests:
    - test_integration/test_ipahealthcheck.py::TestIpaHealthCheck
    containers:
      replicas: 1

- vm_jobs:
  - container_job: ipahealthcheck_TestIpaHealthCheckWithoutDNS
    tests:
    - test_integration/test_ipahealthcheck.py::TestIpaHealthCheckWithoutDNS
    containers:
      replicas: 1

  - container_job: ipahealthcheck_TestIpaHealthCheckWithExternalCA
    tests:
    - test_integration/test_ipahealthcheck.py::TestIpaHealthCheckWithExternalCA
    containers:
      replicas: 1
